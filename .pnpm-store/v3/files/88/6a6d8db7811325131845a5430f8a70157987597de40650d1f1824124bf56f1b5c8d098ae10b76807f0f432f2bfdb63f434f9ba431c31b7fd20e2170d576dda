{"version":3,"sources":["../../../src/utils/worker/reporter.ts"],"names":["initReporterMessagingInMainProcess","workerPool","reporter","_initReporterMessagingInMain","onMessage","bind","gatsbyWorkerMessenger","initReporterMessagingInWorker","isWorker","_initReporterMessagingInWorker","sendMessage","process","on","reason","panic","err"],"mappings":";;;;;;;;AAAA;;AAEA;;AAEO,SAASA,kCAAT,CACLC,UADK,EAEC;AACN,MAAI,OAAOC,kBAASC,4BAAhB,KAAkD,UAAtD,EAAiE;AAC/DD,sBAASC,4BAAT,CAAsCF,UAAU,CAACG,SAAX,CAAqBC,IAArB,CAA0BJ,UAA1B,CAAtC;AACD;AACF;;AAED,MAAMK,qBAAqB,GAAG,8BAA9B;;AACO,SAASC,6BAAT,GAA+C;AACpD,MACEC,uBACAF,qBADA,IAEA,OAAOJ,kBAASO,8BAAhB,KAAoD,UAHtD,EAIE;AACAP,sBAASO,8BAAT,CACEH,qBAAqB,CAACI,WAAtB,CAAkCL,IAAlC,CAAuCC,qBAAvC,CADF;;AAIAK,IAAAA,OAAO,CAACC,EAAR,CAAY,oBAAZ,EAAkCC,MAAD,IAAqB;AACpDX,wBAASY,KAAT,CAAgBD,MAAD,IAAsB,qBAArC;AACD,KAFD;AAIAF,IAAAA,OAAO,CAACC,EAAR,CAAY,mBAAZ,EAAgC,UAAUG,GAAV,EAAe;AAC7Cb,wBAASY,KAAT,CAAeC,GAAf;AACD,KAFD;AAGD;AACF","sourcesContent":["import reporter from \"gatsby-cli/lib/reporter\"\nimport { GatsbyWorkerPool } from \"./types\"\nimport { isWorker, getMessenger } from \"./messaging\"\n\nexport function initReporterMessagingInMainProcess(\n  workerPool: GatsbyWorkerPool\n): void {\n  if (typeof reporter._initReporterMessagingInMain === `function`) {\n    reporter._initReporterMessagingInMain(workerPool.onMessage.bind(workerPool))\n  }\n}\n\nconst gatsbyWorkerMessenger = getMessenger()\nexport function initReporterMessagingInWorker(): void {\n  if (\n    isWorker &&\n    gatsbyWorkerMessenger &&\n    typeof reporter._initReporterMessagingInWorker === `function`\n  ) {\n    reporter._initReporterMessagingInWorker(\n      gatsbyWorkerMessenger.sendMessage.bind(gatsbyWorkerMessenger)\n    )\n\n    process.on(`unhandledRejection`, (reason: unknown) => {\n      reporter.panic((reason as Error) || `Unhandled rejection`)\n    })\n\n    process.on(`uncaughtException`, function (err) {\n      reporter.panic(err)\n    })\n  }\n}\n"],"file":"reporter.js"}