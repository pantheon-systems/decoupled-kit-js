{"version":3,"sources":["../../../../src/steps/source-nodes/before-change-node/menu.js"],"names":["deleteMenuNodeChildMenuItems","node","pluginOptions","helpers","getNodesByType","actions","allMenuItems","schema","typePrefix","allMenuItemsNodesWithThisMenuIdAsAParent","filter","menuItemNode","menu","id","deleteNode","menuBeforeChangeNode","api","remoteNode","actionType"],"mappings":";;;;;AAAA;;AAEA,MAAMA,4BAA4B,GAAGC,IAAI,IAAI;AAC3C,QAAM;AACJC,IAAAA,aADI;AAEJC,IAAAA,OAAO,EAAE;AAAEC,MAAAA,cAAF;AAAkBC,MAAAA;AAAlB;AAFL,MAGF,iCAHJ;AAKA,QAAMC,YAAY,GAAGF,cAAc,CAChC,GAAEF,aAAa,CAACK,MAAd,CAAqBC,UAAW,UADF,CAAnC;AAIA,QAAMC,wCAAwC,GAAGH,YAAY,CAACI,MAAb,CAC/CC,YAAY,IAAIA,YAAY,CAACC,IAAb,CAAkBX,IAAlB,CAAuBY,EAAvB,KAA8BZ,IAAI,CAACY,EADJ,CAAjD;;AAIA,OAAK,MAAMF,YAAX,IAA2BF,wCAA3B,EAAqE;AACnEJ,IAAAA,OAAO,CAACS,UAAR,CAAmBH,YAAnB;AACD;AACF,CAjBD;;AAmBO,MAAMI,oBAAoB,GAAG,MAAMC,GAAN,IAAa;AAC/C,MAAIA,GAAG,CAACC,UAAJ,IAAkBD,GAAG,CAACE,UAAJ,KAAoB,QAA1C,EAAmD;AACjD;AACA,WAAOlB,4BAA4B,CAACgB,GAAG,CAACC,UAAL,CAAnC;AACD;;AAED,SAAO,IAAP;AACD,CAPM","sourcesContent":["import { getGatsbyApi } from \"~/utils/get-gatsby-api\"\n\nconst deleteMenuNodeChildMenuItems = node => {\n  const {\n    pluginOptions,\n    helpers: { getNodesByType, actions },\n  } = getGatsbyApi()\n\n  const allMenuItems = getNodesByType(\n    `${pluginOptions.schema.typePrefix}MenuItem`\n  )\n\n  const allMenuItemsNodesWithThisMenuIdAsAParent = allMenuItems.filter(\n    menuItemNode => menuItemNode.menu.node.id === node.id\n  )\n\n  for (const menuItemNode of allMenuItemsNodesWithThisMenuIdAsAParent) {\n    actions.deleteNode(menuItemNode)\n  }\n}\n\nexport const menuBeforeChangeNode = async api => {\n  if (api.remoteNode && api.actionType === `DELETE`) {\n    // delete child menu items\n    return deleteMenuNodeChildMenuItems(api.remoteNode)\n  }\n\n  return null\n}\n"],"file":"menu.js"}