{"version":3,"sources":["../../../../src/datastore/lmdb/updates/nodes.ts"],"names":["updateNodes","nodesDb","action","type","put","payload","id","remove","path","node","get","Error","mode","pageMode"],"mappings":";;;;;AAKO,SAASA,WAAT,CACLC,OADK,EAELC,MAFK,EAGuB;AAC5B,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,aAAN;AACA,SAAM,mBAAN;AACA,SAAM,+BAAN;AAAsC;AACpC,eAAOF,OAAO,CAACG,GAAR,CAAYF,MAAM,CAACG,OAAP,CAAeC,EAA3B,EAA+BJ,MAAM,CAACG,OAAtC,CAAP;AACD;;AACD,SAAM,aAAN;AAAoB;AAClB,YAAIH,MAAM,CAACG,OAAX,EAAoB;AAClB,iBAAOJ,OAAO,CAACM,MAAR,CAAeL,MAAM,CAACG,OAAP,CAAeC,EAA9B,CAAP;AACD;;AAED,eAAO,KAAP;AACD;;AACD,SAAM,uBAAN;AAA8B;AAC5B,cAAMA,EAAE,GAAI,YAAWJ,MAAM,CAACG,OAAP,CAAeG,IAAK,EAA3C;AACA,cAAMC,IAAI,GAAGR,OAAO,CAACS,GAAR,CAAYJ,EAAZ,CAAb;;AACA,YAAI,CAACG,IAAL,EAAW;AACT,gBAAM,IAAIE,KAAJ,CAAW,uCAAsCL,EAAG,EAApD,CAAN;AACD;;AACDG,QAAAA,IAAI,CAACG,IAAL,GAAYV,MAAM,CAACG,OAAP,CAAeQ,QAA3B;AACA,eAAOZ,OAAO,CAACG,GAAR,CAAYE,EAAZ,EAAgBG,IAAhB,CAAP;AACD;AArBH;;AAuBA,SAAO,KAAP;AACD","sourcesContent":["import { ActionsUnion, IGatsbyNode } from \"../../../redux/types\"\nimport type { Database } from \"lmdb\"\n\ntype NodeId = string\n\nexport function updateNodes(\n  nodesDb: Database<IGatsbyNode, NodeId>,\n  action: ActionsUnion\n): Promise<boolean> | boolean {\n  switch (action.type) {\n    case `CREATE_NODE`:\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`: {\n      return nodesDb.put(action.payload.id, action.payload)\n    }\n    case `DELETE_NODE`: {\n      if (action.payload) {\n        return nodesDb.remove(action.payload.id)\n      }\n\n      return false\n    }\n    case `MATERIALIZE_PAGE_MODE`: {\n      const id = `SitePage ${action.payload.path}`\n      const node = nodesDb.get(id)\n      if (!node) {\n        throw new Error(`Could not find SitePage node by id: ${id}`)\n      }\n      node.mode = action.payload.pageMode\n      return nodesDb.put(id, node)\n    }\n  }\n  return false\n}\n"],"file":"nodes.js"}