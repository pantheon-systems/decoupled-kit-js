import { NextSeo } from "next-seo";
import Layout from "../../components/layout";
import Post from "../../components/post";

import { getFooterMenu } from "../../lib/Menus";
import { getPostBySlug } from "../../lib/Posts";

export default function PostListTemplate({ menuItems, post }) {
  return (
    <Layout footerMenu={menuItems}>
      <NextSeo
        title="Decoupled Next WordPress Demo"
        description="Generated by create next app."
      />
      <Post post={post} />
    </Layout>
  );
}

export async function getServerSideProps({ params }) {
  const menuItems = await getFooterMenu();
  const { slug } = params;
  const post = await getPostBySlug(slug);

  if (!post) {
    return {
      notFound: true,
    };
  }

  return {
    props: {
      menuItems,
      post,
    },
  };
}
