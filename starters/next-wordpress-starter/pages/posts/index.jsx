import { NextSeo } from 'next-seo';

import PageHeader from '../../components/page-header';
import Layout from '../../components/layout';
import { withGrid, PostGridItem } from '../../components/grid';

import { getFooterMenu } from '../../lib/Menus';
import { getLatestPosts } from '../../lib/Posts';

export default function PostsListTemplate({ menuItems, SSRPosts }) {
	const PostGrid = withGrid(PostGridItem);

	return (
		<Layout footerMenu={menuItems}>
			<NextSeo
				title="Decoupled Next WordPress Demo"
				description="Generated by create next app."
			/>
			<PageHeader title="Posts" />
			<section>
				<PostGrid contentType="posts" data={SSRPosts} />
			</section>
		</Layout>
	);
}

export async function getServerSideProps() {
	const menuItems = await getFooterMenu();
	const SSRPosts = await getLatestPosts();

	return {
		props: {
			menuItems,
			SSRPosts,
		},
	};
}
